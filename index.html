<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transparent Barcode Generator</title>
<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    background: #f5f5f5;
    font-family: Arial, sans-serif;
    padding: 20px;
  }
  input, button {
    margin: 5px;
    padding: 8px 12px;
    font-size: 16px;
  }
</style>
</head>
<body>

<h2>Transparent Barcode Generator</h2>

<input type="text" id="barcodeValue" placeholder="Enter Barcode Value">
<input type="color" id="barcodeColor" value="#000000">
<button onclick="generateBarcode()">Generate</button>
<button onclick="downloadBarcode()">Download Transparent PNG</button>

<svg id="barcode"></svg>

<script>
function generateBarcode() {
  const value = document.getElementById("barcodeValue").value.trim();
  if (!value) return alert("Please enter a barcode value!");
  
  const color = document.getElementById("barcodeColor").value;

  JsBarcode("#barcode", value, {
    format: "CODE128",
    lineColor: color,
    width: 2,
    height: 100,
    displayValue: true, // Show number below barcode
    margin: 0 // Remove extra margin
  });
}

function downloadBarcode() {
  const svg = document.getElementById("barcode");
  if (!svg.hasChildNodes()) return alert("Generate a barcode first!");

  const serializer = new XMLSerializer();
  const svgString = serializer.serializeToString(svg);
  const canvas = document.createElement("canvas");
  const ctx = canvas.getContext("2d");
  const img = new Image();

  img.onload = function() {
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.clearRect(0, 0, canvas.width, canvas.height); // Fully transparent
    ctx.drawImage(img, 0, 0);

    const link = document.createElement("a");
    link.href = canvas.toDataURL("image/png");
    link.download = "barcode_transparent.png";
    link.click();
  };

  img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgString)));
}
</script>

</body>
</html>
